<!--
`clearable-input` is a Polymer element that encapsulates the idea of a text input that has a clickable icon inside the element to clear the input.

<clearable-input></clearable-input>

@author Brent Hosie
@element clearable-input
@homepage http://github.com/xrapiddavex/clearable-input/
-->

<link rel="import" href="../polymer/polymer.html"/>
<link rel="import" href="../iron-icons/iron-icons.html">

<dom-module id="clearable-input">
	<link rel="stylesheet" type="text/css" href="./clearable-input.css"/>
	<template>		
		<span class="wrapper">
            <input type="text" id="textInput" placeholder="{{placeholder}}" value="{{value}}" on-click="fireClicked" on-input="valueChanged"/>
            <div id="iconWrapper">
            	<iron-icon id="clearInput" icon="{{icon}}" on-click="testClearInput" hidden$="{{clearHidden}}"></iron-icon>
            <div>
        </span>
	</template>
	<script>
		(function() {
			"use strict";

			Polymer({
				is: "clearable-input",

				properties: {
					placeholder: {
						type: String,
						value: "",
						notify: true
					},
					value: {
						type: String,
						value: "",
						observer: "valueChanged",
						notify: true
					},
					readonly: {
						type: Boolean,
						value: false,
						notify: true
					},
					isDisabled: {
						type: Boolean,
						value: false,
						notify: true
					},
					backgroundColor: {
						type: String,
						value: "#FFF",
						notify: true
					},
					color: {
						type: String,
						value: "#000",
						notify: true
					},
					icon: {
						type: String,
						value: "clear",
						notify: true
					},
					clearHidden: {
						type: Boolean,
						value: true,
						notify: true
					}
				},
				/**
	            * The placeholder of the text input
	            *
	            * @attribute placeholder
	            * @access public
	            * @type string
	            * @default ''
	            */

				/**
	            * The value of the text input
	            *
	            * @attribute value
	            * @access public
	            * @type string
	            * @default ''
	            */

				/**
	            * The background color of the text input. This field supports
	            * hexidecimal and standard html colors.
	            *
	            * @attribute backgroundColor
	            * @access public
	            * @type string
	            * @default '#FFF'
	            */

				/**
	            * The color of the text input's text, and text input's clear button.
	            * This field supports hexidecimal and standard html colors.
	            *
	            * @attribute color
	            * @access public
	            * @type string
	            * @default '#000'
	            */

				/**
	            * Whether or not to show the clear input
	            *
	            * attribute clearHidden
	            * access public
	            * type boolean
	            * default true
	            */
				

				/**
				* On Polymer ready, set defaults
				*/
				ready: function() {
					/**
		            * If set on the element, makes the text input readonly. The text input is still clearable.
		            *
		            * @attribute readonly
		            * @access public
		            * @type boolean
		            * @default undefined
		            */
					// this.$.textInput.readOnly = (this.readonly !== void 0);
					/**
		            * If set on the element, makes the text input disabled. The text input will not be clearable.
		            * isDisabled overrides readonly.
		            *
		            * @attribute isDisabled
		            * @access public
		            * @type boolean
		            * @default undefined
		            */
					// this.$.textInput.disabled = (this.isDisabled !== void 0);
					/**
		            * The iron-icon that's used for clearing the input text
		            *
		            * @attribute icon
		            * @access public
		            * @type string
		            * @default 'clear'
		            */
					// if(typeof this.icon !== 'string' || this.icon.length === 0) {
					// 	this.icon = "clear";
					// }

					// setInterval(function() {
					// 	this.clearHidden = this.$.textInput.value.length === 0 || this.isDisabled !== void 0;
					// }.bind(this), 100);


				},

				/**
				* Tests whether or not clicking on the clear button should clear the value.
				* Returns true if the isDisabled attribute is not set, false otherwise.
				*
				* function testClearInput
				* access public
				* returns boolean
				*/
				testClearInput: function() {
					if(this.isDisabled === void 0) {
						this.clearInput();
						return true;
					}

					return false;
				},

				/**
				* Programmatically clears the value of the text input
				*
				* @method clearInput
				* @access public
				* @returns boolean
				*/
				clearInput: function() {
					this.value='';
					/**
                    * Fires when the the value of the text input is cleared
                    *
                    * @event clear
                    */
					this.fire('clear');
					return true;
				},

				/**
				* Is called when the value of the text input changes
				*
				* @method valueChanged
				* @access public
				* @returns undefined
				*/
				valueChanged: function() {
					/**
                    * Fires when the the value of the text input is changed
                    *
                    * @event change
                    */
					this.fire('change');
				},

				/**
				* Is called when the text input is clicked on. This will allow people to tell when the input itself is clicked,
				* not when the clearable button is clicked
				*
				* method valueChanged
				* access public
				* returns undefined
				*/
				fireClicked: function() {
					/**
                    * Fires only when the input itself is clicked, not when the clearable button is clicked
                    *
                    * @event inputclicked
                    */
					this.fire('inputclicked');
				}
			});
		})();
	</script>
</dom-element>